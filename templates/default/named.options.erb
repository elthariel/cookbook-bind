# Generated by Chef for <%= node['fqdn'] %>
# Local modifications will be overwritten.

<% each_resource('named_acl', @acls) do |acl| %>
acl "<%= acl.name %>" {
  <% acl.match.each do |match_item| %>
  <%= match_item %>;
  <% end %>
};
<% end  %>

masters default { <% node['named']['masters'].each do |host| -%><%= host -%>; <% end -%> };

options {
  directory "<%= node['named']['vardir'] %>";
  dump-file "data/cache_dump.db";
  statistics-file "data/named_stats.txt";
  memstatistics-file "data/named_mem_stats.txt";
  <% if node['named']['ipv6_listen'] -%>listen-on-v6 { any; };<% end -%>
  <% node['named']['options'].each do |option_line| -%>
  <%= option_line %>
  <% end -%>
};

<% if node['named']['enable_log'] %>
logging {
  channel b_query {
    file "<%= node['named']['log_file'] %>" versions <%= node['named']['log_file_versions'] %> size <%= node['named']['log_file_size'] %>;
    print-time yes;
    severity info;
    <% node['named']['log_options'].each do |option_line| -%>
    <%= option_line %>
    <% end -%>
  };
  category queries { b_query; };
};
<% end %>

<% unless node['named']['statistics-channel'] %>
statistics-channels {
  inet * port <%= node['named']['statistics-port'] -%>;
};
<% end %>
